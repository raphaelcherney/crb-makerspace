<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>CRB Makerspace – 3D Printer Scheduler</title>
    <link rel="stylesheet" href="styles.css" />
    <!-- Supabase client is imported in app.js -->
  </head>
  <body>
    <header class="app-header">
      <h1>3D Printer Scheduler</h1>
      <div class="controls">
        <button id="prevDay" aria-label="Previous day">◀</button>
        <button id="todayBtn">Today</button>
        <button id="nextDay" aria-label="Next day">▶</button>
        <input id="datePicker" type="date" />
      </div>
    </header>

    <main class="calendar-container">
      <div class="loading" id="loading">
        <div class="spinner"></div>
        <div class="loading-text">Loading reservations...</div>
      </div>
      <div class="calendar" id="calendar">
        <div class="time-col" id="timeCol"></div>
        <div class="calendar-right">
          <div class="printers-wrapper">
            <div class="printers-header" id="printersHeader"></div>
            <div class="printers" id="printers"></div>
          </div>
        </div>
      </div>
    </main>

    <dialog id="reservationDialog">
      <form method="dialog" id="reservationForm">
        <h2>New Reservation</h2>
        <div class="field">
          <label for="resPrinter">Printer</label>
          <select id="resPrinter" required></select>
        </div>
        <div class="row">
          <div class="field">
            <label for="resDate">Date</label>
            <input id="resDate" type="date" required />
          </div>
          <div class="field">
            <label for="resStart">Start</label>
            <input id="resStart" type="time" step="1800" required />
          </div>
          <div class="field">
            <label for="resDuration">Duration (hours)</label>
            <input id="resDuration" type="number" min="0.5" max="168" step="0.5" value="0.5" required />
          </div>
        </div>
        <div class="row">
          <div class="field" style="opacity: 0.6;">
            <label for="resEndDisplay">End (calculated)</label>
            <input id="resEndDisplay" type="time" readonly />
            <div id="endMultiDayNote" style="font-size:12px; color: var(--muted);"></div>
          </div>
        </div>
        <div class="field">
          <label for="resName">Name</label>
          <input id="resName" type="text" maxlength="80" required />
        </div>
        <div class="field">
          <label for="resContact">Contact (email or phone)</label>
          <input id="resContact" type="text" maxlength="120" required />
        </div>
        <div class="row">
          <div class="field">
            <label for="resLab">Lab/Program</label>
            <select id="resLab" required></select>
            <input id="resLabOther" type="text" placeholder="Specify lab/program" maxlength="80" style="display:none; margin-top:6px;" />
          </div>
          <div class="field">
            <label for="resMaterial">Filament Material</label>
            <select id="resMaterial" required></select>
            <input id="resMaterialOther" type="text" placeholder="Specify material" maxlength="80" style="display:none; margin-top:6px;" />
          </div>
        </div>
        <div class="field">
          <label for="resNotes">Notes</label>
          <input id="resNotes" type="text" maxlength="200" />
        </div>
        <div class="error" id="formError" role="alert" aria-live="assertive"></div>
        <menu class="dialog-actions">
          <button type="reset" id="cancelBtn">Cancel</button>
          <button type="submit" id="reserveBtn" value="confirm">Reserve</button>
        </menu>
      </form>
    </dialog>

    <template id="printerColumnTemplate">
      <div class="printer-col">
        <div class="printer-header"></div>
        <div class="slots"></div>
      </div>
    </template>

    <script type="module" src="app.js"></script>
  </body>
  </html>


